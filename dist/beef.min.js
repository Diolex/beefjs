var Beef=new function(){return{}};Beef.Api=new function(){return{throttle:function(e,n,t){var i;return function(){var r=this,a=arguments,o=function(){i=null,t||e.apply(r,a)},s=t&&!i;clearTimeout(i),i=setTimeout(o,n),s&&e.apply(r,a)}},_buildUrl:function(e,n,t){for(var i in n)-1===e.indexOf("{"+i+"}")?("undefined"==typeof t||t!==!1)&&(e+=-1!==e.indexOf("?")?"&":"?",e+=i+"="+n[i]):e=e.replace("{"+i+"}",n[i]);return e},get:function(e,n){return $.ajax({url:this._buildUrl(e,n),data:JSON.stringify(n),method:"GET",dataType:"json"})},post:function(e,n){return $.ajax({url:this._buildUrl(e,n,!1),data:JSON.stringify(n),method:"POST",dataType:"json"})},put:function(e,n){return $.ajax({url:this._buildUrl(e,n,!1),data:JSON.stringify(n),method:"PUT",dataType:"json"})},"delete":function(e,n){return $.ajax({url:this._buildUrl(e,n),data:JSON.stringify(n),method:"DELETE",dataType:"json"})}}},Beef.Dispatcher=new function(){return{max_iterations:10,callbacks:[],register:function(e,n){var t=this.callbacks.length;return this.callbacks.push({func:e,dependencies:n,dispatch_id:t}),t},dispatch:function(e,n){for(var t={action:e,data:n},i=[],r=0,a=0;r<Dispatcher.max_iterations&&i.length<Dispatcher.callbacks.length;){a>=Dispatcher.callbacks.length&&(a=0,r++);var o=Dispatcher.callbacks[a];("undefined"==typeof o.dependencies||i.filter(function(e){return-1!==o.dependencies.indexOf(e)}).length===o.dependencies.length)&&(o.func(t),i.push(o.dispatch_id),a++)}r>=Dispatcher.max_iterations&&console.warn("Hit max dispatcher iterations, check dependencies of callbacks")}}},Beef.Store=new function(){return $=jQuery.noConflict(),{rows:{},create:function(e){if("undefined"==typeof e)throw new Error("Invalid store configuration, please supply a valid Javascript Object");var n={};return $.extend(!0,n,this,e),n},listen:function(e,n){$(window).on(e,n)},ignore:function(e,n){$(window).off(e,n)},stopListen:function(e,n){this.ignore(e,n)},emit:function(e,n){$(window).trigger(e,[n])},_merge:function(e,n,t){"undefined"==typeof t&&(t=1);var i=this;if(3===t)return n;for(var r in n)try{n[r].constructor===Object?e[r]=i._merge(e[r],n[r],t+1):e[r]=n[r]}catch(a){e[r]=n[r]}return e},upsertRow:function(e,n,t,i){var r=!1;"undefined"==typeof this.rows[e]&&(this.rows[e]=[]);var a=this.rows[e],o=this;a.forEach(function(e,s){"undefined"!=typeof e[n]&&e[n]===t&&("undefined"==typeof a[s]&&(a[s]={}),a[s]=o._merge(a[s],i),r=!0)}),r||this.rows[e].push(i)},removeRow:function(e,n,t){if("undefined"!=typeof this.rows[e]){var r=this.rows[e],a=[];if(r.forEach(function(e,i){"undefined"!=typeof e[n]&&e[n]==t&&a.push(i)}),0!==a.length)for(i=0;i<a.length;i++)this.rows[e].splice(a[i],1)}},getRows:function(e){return"undefined"!=typeof this.rows[e]?this.rows[e].slice(0):[]},sanitizeAndValidate:function(e,n){var t=this.sanitize(e,n),i=this.validate(t,n);return i===!0?t:i},validate:function(e,n){var t=[];for(var i in n)if("undefined"!=typeof n[i].validation){var r=!1;for(var a in n[i].validation)if(!r){var o=e[i];if("undefined"!=typeof n[i].label)var s=n[i].label;else var s=i;switch(a){case"required":("undefined"==typeof o||null===o||""===o)&&(t.push(s+" is required"),r=!0);break;case"minLength":o.length<n[i].validation[a]&&(t.push(s+" must be at least "+n[i].validation[a]+" characters"),r=!0);break;case"maxLength":o.length>n[i].validation[a]&&(t.push(s+" must be at under "+n[i].validation[a]+" characters"),r=!0);break;default:if("function"==typeof n[i].validation[a]){var u=n[i].validation[a](o);u!==!0&&(t.concat(u),r=!0)}}}}return t.length>0?t:!0},sanitize:function(e,n,t){var i={},r=jQuery.extend(!0,{},e);for(var a in n)i[a]=this._sanitizeField(a,r,n,t);return i},_sanitizeField:function(e,n,t,i){if("function"===t[e].type)return t[e].value;"undefined"==typeof n[e]&&("undefined"!=typeof t[e].initial?n[e]=t[e].initial():n[e]=null);var r=t[e].type;if(null===n[e]&&"obj"!==r&&"object"!==r)return null;switch(t[e].field=e,r){case"int":case"integer":return this._sanitizeInteger(n[e],t[e]);case"float":case"double":return this._sanitizeFloat(n[e],t[e]);case"string":case"char":case"varchar":return this._sanitizeString(n[e],t[e]);case"date":case"datetime":case"timestamp":return this._sanitizeDateTime(n[e],t[e],i);case"bool":case"boolean":return this._sanitizeBoolean(n[e],t[e]);case"obj":case"object":return this._sanitizeObject(n[e],t[e],i);case"array":case"collection":return this._sanitizeArray(n[e],t[e]);default:if("undefined"!==t[e].sanitize)return t[e].sanitize(n[e],t[e])}},_sanitizeInteger:function(e,n){if("string"==typeof e&&(e=e.replace(/[a-zA-Z]+/gi,""),0===e.length))return e="";if(e=parseInt(e),"undefined"!=typeof n.min&&e<n.min)throw new Error("Provided value cannot be sanitized, value is below minimum integer allowed");if("undefined"!=typeof n.max&&e>n.max)throw new Error("Provided value cannot be sanitized, value is greater than maximum integer allowed");return isNaN(e)?e="":e},_sanitizeFloat:function(e,n){if(e=parseFloat(e),"undefined"!=typeof n.min&&e<n.min)throw new Error("Provided value cannot be sanitized, value is below minimum float allowed");if("undefined"!=typeof n.max&&e>n.max)throw new Error("Provided value cannot be sanitized, value is greater than maximum float allowed");return e},_sanitizeString:function(e,n){if(e=String(e),"undefined"!=typeof n.minLength&&e.length<n.minLength)throw new Error("Provided value cannot be sanitized, string length is below minimum allowed");return"undefined"!=typeof n.maxLength&&e.length>n.maxLength&&(console.warn("Value was truncated during sanitation"),e=e.substr(0,n.maxLength)),e},_sanitizeDateTime:function(e,n,t){if(moment(e,n.format).isValid())return t?moment(e).utc().format("YYYY-MM-DD hh:mm:ss"):"undefined"==typeof n.utc||n.utc?moment.utc(e):moment(e);throw new Error("Provided value ("+e+") cannot be sanitized for field ("+n.field+"), is not a valid date")},_sanitizeBoolean:function(e,n){if(e===!1||e===!0)return e;if("string"==typeof e){if("false"===e.toLowerCase().trim())return!1;if("true"===e.toLowerCase().trim())return!0}if(0===parseInt(e))return!1;if(1===parseInt(e))return!0;throw new Error("Provided value cannot be santized, is not a valid boolean")},_sanitizeObject:function(e,n,t){if("undefined"==typeof n.schema)throw new Error("Provided value cannot be santized, no reference schema provided for field type of object");return null===n.schema?e:null===e?null:this.sanitize(e,n.schema())},_sanitizeArray:function(e,n){if("undefined"==typeof n.schema||null===n.schema||n.schema===!1)return e;if("undefined"==typeof e.length)return[];var t=this;return e.map(function(e){return t.sanitize(e,n.schema())})},uuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var n=16*Math.random()|0,t="x"==e?n:3&n|8;return t.toString(16)})},sortBy:function(e,n){return function(n,t){var i=i?i:"desc";return t[e]&&!n[e]||t[e]&&n[e]&&t[e]>n[e]?"desc"===i.toLowerCase()?1:-1:!t[e]&&n[e]||t[e]&&n[e]&&t[e]<n[e]?"desc"===i.toLowerCase()?-1:1:t[e]&&n[e]&&t[e]==n[e]?0:t[e]&&!n[e]?0:void 0}},money:function(e){return e.toFixed(2)}}};