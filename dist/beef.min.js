var Beef=new function(){return{}};Beef.Api=new function(){return{throttle:function(e,t,n){var i;return function(){var r=this,a=arguments,o=function(){i=null,n||e.apply(r,a)},u=n&&!i;clearTimeout(i),i=setTimeout(o,t),u&&e.apply(r,a)}},_buildUrl:function(e,t,n){for(var i in t)-1===e.indexOf("{"+i+"}")?("undefined"==typeof n||n!==!1)&&(e+=-1!==e.indexOf("?")?"&":"?",e+=i+"="+t[i]):e=e.replace("{"+i+"}",t[i]);return e},get:function(e,t){return $.ajax({url:this._buildUrl(e,t),data:JSON.stringify(t),method:"GET",dataType:"json"})},post:function(e,t){return $.ajax({url:this._buildUrl(e,t,!1),data:JSON.stringify(t),method:"POST",dataType:"json"})},put:function(e,t){return $.ajax({url:this._buildUrl(e,t,!1),data:JSON.stringify(t),method:"PUT",dataType:"json"})},"delete":function(e,t){return $.ajax({url:this._buildUrl(e,t),data:JSON.stringify(t),method:"DELETE",dataType:"json"})}}},Beef.Dispatcher=new function(){return{max_iterations:10,callbacks:[],register:function(e,t){var n=this.callbacks.length;return this.callbacks.push({func:e,dependencies:t,dispatch_id:n}),n},dispatch:function(e,t){for(var n={action:e,data:t},i=[],r=0,a=0;r<Beef.Dispatcher.max_iterations&&i.length<Beef.Dispatcher.callbacks.length;){a>=Beef.Dispatcher.callbacks.length&&(a=0,r++);var o=Beef.Dispatcher.callbacks[a];("undefined"==typeof o.dependencies||i.filter(function(e){return-1!==o.dependencies.indexOf(e)}).length===o.dependencies.length)&&(o.func(n),i.push(o.dispatch_id),a++)}r>=Beef.Dispatcher.max_iterations&&console.warn("Hit max dispatcher iterations, check dependencies of callbacks")}}},Beef.Store=new function(){return $=jQuery.noConflict(),{rows:{},create:function(e){if("undefined"==typeof e)throw new Error("Invalid store configuration, please supply a valid Javascript Object");var t={};return $.extend(!0,t,this,e),t},listen:function(e,t){$(window).on(e,t)},ignore:function(e,t){$(window).off(e,t)},stopListen:function(e,t){this.ignore(e,t)},emit:function(e,t){$(window).trigger(e,[t])},_merge:function(e,t,n){"undefined"==typeof n&&(n=1);var i=this;if(3===n)return t;for(var r in t)try{t[r].constructor===Object?e[r]=i._merge(e[r],t[r],n+1):e[r]=t[r]}catch(a){e[r]=t[r]}return e},upsertRow:function(e,t,n,i){var r=!1;"undefined"==typeof this.rows[e]&&(this.rows[e]=[]);var a=this.rows[e],o=this;a.forEach(function(e,u){"undefined"!=typeof e[t]&&e[t]===n&&("undefined"==typeof a[u]&&(a[u]={}),a[u]=o._merge(a[u],i),r=!0)}),r||this.rows[e].push(i)},removeRow:function(e,t,n){if("undefined"!=typeof this.rows[e]){var r=this.rows[e],a=[];if(r.forEach(function(e,i){"undefined"!=typeof e[t]&&e[t]==n&&a.push(i)}),0!==a.length)for(i=0;i<a.length;i++)this.rows[e].splice(a[i],1)}},getRows:function(e){return"undefined"!=typeof this.rows[e]?this.rows[e].slice(0):[]},sanitizeAndValidate:function(e,t){var n=this.sanitize(e,t),i=this.validate(n,t);return i===!0?n:i},validate:function(e,t){var n=[];for(var i in t)if("undefined"!=typeof t[i].validation){var r=!1;for(var a in t[i].validation)if(!r){var o=e[i];if("undefined"!=typeof t[i].label)var u=t[i].label;else var u=i;switch(a){case"required":("undefined"==typeof o||null===o||""===o)&&(n.push(u+" is required"),r=!0);break;case"minLength":o.length<t[i].validation[a]&&(n.push(u+" must be at least "+t[i].validation[a]+" characters"),r=!0);break;case"maxLength":o.length>t[i].validation[a]&&(n.push(u+" must be at under "+t[i].validation[a]+" characters"),r=!0);break;default:if("function"==typeof t[i].validation[a]){var s=t[i].validation[a](o);s!==!0&&(n.concat(s),r=!0)}}}}return n.length>0?n:!0},sanitize:function(e,t,n){var i={},r=jQuery.extend(!0,{},e);for(var a in t)i[a]=this._sanitizeField(a,r,t,n);return i},_sanitizeField:function(e,t,n,i){if("function"===n[e].type)return n[e].value;"undefined"==typeof t[e]&&("undefined"!=typeof n[e].initial?t[e]=n[e].initial():t[e]=null);var r=n[e].type;if(null===t[e]&&"obj"!==r&&"object"!==r)return null;switch(n[e].field=e,r){case"int":case"integer":return this._sanitizeInteger(t[e],n[e]);case"float":case"double":return this._sanitizeFloat(t[e],n[e]);case"string":case"char":case"varchar":return this._sanitizeString(t[e],n[e]);case"date":case"datetime":case"timestamp":return this._sanitizeDateTime(t[e],n[e],i);case"bool":case"boolean":return this._sanitizeBoolean(t[e],n[e]);case"obj":case"object":return this._sanitizeObject(t[e],n[e],i);case"array":case"collection":return this._sanitizeArray(t[e],n[e]);default:if("undefined"!==n[e].sanitize)return n[e].sanitize(t[e],n[e])}},_sanitizeInteger:function(e,t){if("string"==typeof e&&(e=e.replace(/[a-zA-Z]+/gi,""),0===e.length))return e="";if(e=parseInt(e),"undefined"!=typeof t.min&&e<t.min)throw new Error("Provided value cannot be sanitized, value is below minimum integer allowed");if("undefined"!=typeof t.max&&e>t.max)throw new Error("Provided value cannot be sanitized, value is greater than maximum integer allowed");return isNaN(e)?e="":e},_sanitizeFloat:function(e,t){if(e=parseFloat(e),"undefined"!=typeof t.min&&e<t.min)throw new Error("Provided value cannot be sanitized, value is below minimum float allowed");if("undefined"!=typeof t.max&&e>t.max)throw new Error("Provided value cannot be sanitized, value is greater than maximum float allowed");return e},_sanitizeString:function(e,t){if(e=String(e),"undefined"!=typeof t.minLength&&e.length<t.minLength)throw new Error("Provided value cannot be sanitized, string length is below minimum allowed");return"undefined"!=typeof t.maxLength&&e.length>t.maxLength&&(console.warn("Value was truncated during sanitation"),e=e.substr(0,t.maxLength)),e},_sanitizeDateTime:function(e,t,n){if(moment(e,t.format).isValid())return n?moment(e).utc().format("YYYY-MM-DD hh:mm:ss"):"undefined"==typeof t.utc||t.utc?moment.utc(e):moment(e);throw new Error("Provided value ("+e+") cannot be sanitized for field ("+t.field+"), is not a valid date")},_sanitizeBoolean:function(e,t){if(e===!1||e===!0)return e;if("string"==typeof e){if("false"===e.toLowerCase().trim())return!1;if("true"===e.toLowerCase().trim())return!0}if(0===parseInt(e))return!1;if(1===parseInt(e))return!0;throw new Error("Provided value cannot be santized, is not a valid boolean")},_sanitizeObject:function(e,t,n){if("undefined"==typeof t.schema)throw new Error("Provided value cannot be santized, no reference schema provided for field type of object");return null===t.schema?e:null===e?null:this.sanitize(e,t.schema())},_sanitizeArray:function(e,t){if("undefined"==typeof t.schema||null===t.schema||t.schema===!1)return e;if("undefined"==typeof e.length)return[];var n=this;return e.map(function(e){return n.sanitize(e,t.schema())})},uuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"==e?t:3&t|8;return n.toString(16)})},sortBy:function(e,t){return function(t,n){var i=i?i:"desc";return n[e]&&!t[e]||n[e]&&t[e]&&n[e]>t[e]?"desc"===i.toLowerCase()?1:-1:!n[e]&&t[e]||n[e]&&t[e]&&n[e]<t[e]?"desc"===i.toLowerCase()?-1:1:n[e]&&t[e]&&n[e]==t[e]?0:n[e]&&!t[e]?0:void 0}},money:function(e){return e.toFixed(2)}}},Beef.Router=new function(){return{onRoute:function(){},_routes:null,routes:function(e){Beef.Router._routes=e},_activeRoute:"",_routeData:{},route:function(e,t){"undefined"!=typeof Beef.Router._routes[e]&&(Beef.Router._routes[e](t),Beef.Router._activeRoute=e,Beef.Router.onRoute())},doRouting:function(){for(var e in Beef.Router._routes){var t=match_route=e,n=window.location.hash;n.indexOf("?")>=0&&(n=n.substring(0,n.indexOf("?")));var i=e.match(/\{[a-z\_\-\+]+\}/gi),r={};if(null!==i){var a=e.split("/"),o=n.split("/");if(o=o.splice(1,o.length-1),o.length!==a.length)continue;var u=0,s=!1;if(o.forEach(function(e){a[u].match(/\{[a-z\_\-\+]+\}/gi)||e!==a[u]&&(s=!0),u++}),s)continue;match_route="",a.forEach(function(e,t){t>0&&(match_route+="/"),match_route+=o[t],t>0&&(r[e.replace(/[\{\}]/gi,"")]=o[t])})}match_route=match_route.replace("+","\\+");var f=new RegExp("^#/"+match_route+"$","gi");if(null!==n.match(f)){if(Beef.Router._activeRoute===t&&r===Beef.Router._routeData)return;return Beef.Router._routeData=r,Beef.Router._activeRoute=t,void Beef.Router.route(t,r)}}Beef.Router.route("/")},go:function(e){document.location="#/"+e}}};